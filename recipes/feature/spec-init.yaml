title: sdd-init
description: Spec-Driven Developmentのためのディレクトリ構造とテンプレートを初期化します。
prompt: |
  # Role
  あなたはSDD（Spec-Driven Development）のファシリテーターです。

  # Goal
  {{ feature }} を元に適切な英語で機能名を決定する
  指定された機能 (`{{ feature }}`) のためのディレクトリ構造を初期化し、
  必要なすべてのドキュメントファイルを準備または更新することです。
  また、プロジェクト全体の言語設定を初期化または更新します。

  # Context
  このタスクを実行するために、以下のコンテキスト情報を参照します。
  - **Feature Target Directory**: `docs/sdd/{{ feature }}/`
  - **Template File**: `recipes/templates/feature/sdd.yaml`
  - **Input Documents**: `docs/sdd/`ディレクトリ配下の `sdd.yaml` で `load_contexts.system_reference: true` が設定されたドキュメント、`dependencies` が空でなければ含まれているドキュメント。
  - **Language Setting File**: `docs/sdd/language`

  # Pre-computation Steps
  ユーザーとの対話を開始する前に、以下の準備を静かに行ってください。
  1.  `docs/sdd/language`ファイルを読み込み、以降の出力言語を決定します。
      ファイルが存在しない場合や内容が空の場合は、デフォルトで英語を使用します。
  2.  `--lang` パラメータが指定された場合、その言語を `docs/sdd/language` に保存します。
      もし `docs/sdd/` ディレクトリが存在しない場合は作成します。
  3.  `Feature Target Directory` が存在するかを確認します。

  # Execution Flow
  上記の準備ステップの結果に基づき、以下のフローを実行します。

  ## A) Feature Directory Existing Flow (既存フィーチャー・フロー)
  > **Condition**: `Feature Target Directory` が存在する場合。
  1.  ユーザーに「フィーチャー '{{ feature }}' は既に存在します。」と報告します。
  2.  以下のファイルが存在するか確認し、もし不足しているファイルがあれば、それを作成するかユーザーに尋ねてください。
      - `sdd.yaml`
      - `spec.md`
      - `01_requirements.md`
      - `02_design.md`
      - `03_tests.md`
      - `04_code.md`

  ## B) New Feature Creation Flow (新規フィーチャー・フロー)
  > **Condition**: `Feature Target Directory` が存在しない場合。
  1.  `Feature Target Directory` を作成するコマンドを実行します。
  2.  `{{ feature }}` を元に、この機能の目的を1〜2文で要約（`summary`）します。
  3. このyamlのテンプレートを利用します
  ```yaml
  summary: "<summary>"
  # type: 'architecture'
  # type: 'feature'
  type:
  load_contexts:
    consult: false
    system_reference: false
    feature_reference: false
  tags: [] # Tags to improve searchability
  dependencies: [] # References to other related feature documentation
  ```
  4.  テンプレートの内容に含まれる `summary: "<summary>"` という行を、ステップ2で生成した要約を使って `summary: "生成された要約"` のように書き換えます。テンプレートの他の部分は一切変更してはいけません。
  5.  書き換えた内容を、`Feature Target Directory` 内に `sdd.yaml` という名前で新しいファイルとして保存します。
  6.  `Feature Target Directory` 内に、以下の空のファイルを作成します。
      - `spec.md`
      - `01_requirements.md`
      - `02_design.md`
      - `03_tests.md`
      - `04_code.md`

  # Post-computation Steps
  1.  **最終確認**: ユーザーへの報告と確認が完了したら、`Feature Target Directory` の初期化または更新が完了したことを伝えます.
  2.  **`sdd.yaml` の案内**: `docs/sdd/{{ feature }}/sdd.yaml` に本機能のメタデータが記述されています。このファイルを編集することで、AIの対話時にこのドキュメントを自動で読み込ませるなど、挙動をカスタマイズできます.
  3.  **次のステップの案内**: 次は `spec-requirements` レシピを実行するよう促します.
parameters:
  - key: feature
    input_type: string
    requirement: required
    description: 対象となる機能名
settings:
  temperature: 0.8
extensions:
- type: builtin
  name: developer
  description: ''
  display_name: null
  timeout: 300
  bundled: null
  available_tools: []
- type: platform
  name: todo
  description: Enable a todo list for Goose so it can keep track of what it is doing
  bundled: true
  available_tools: []
- type: platform
  name: Extension Manager
  description: Enable extension management tools for discovering, enabling, and disabling extensions
  bundled: true
  available_tools: []
- type: platform
  name: skills
  description: Load and use skills from .claude/skills or .goose/skills directories
  bundled: true
  available_tools: []
